#進捗の判定
##skylands
execute if entity @s[advancements={area:system/island_capture={skylands.001=true}}] run data modify storage area: capture.skylands.001 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.002=true}}] run data modify storage area: capture.skylands.002 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.003=true}}] run data modify storage area: capture.skylands.003 set value 1
# execute if entity @s[advancements={area:system/island_capture={skylands.004=true}}] run data modify storage area: capture.skylands.004 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.005=true}}] run data modify storage area: capture.skylands.005 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.006=true}}] run data modify storage area: capture.skylands.006 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.007=true}}] run data modify storage area: capture.skylands.007 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.008=true}}] run data modify storage area: capture.skylands.008 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.009=true}}] run data modify storage area: capture.skylands.009 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.010=true}}] run data modify storage area: capture.skylands.010 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.011=true}}] run data modify storage area: capture.skylands.011 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.012=true}}] run data modify storage area: capture.skylands.012 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.013=true}}] run data modify storage area: capture.skylands.013 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.014=true}}] run data modify storage area: capture.skylands.014 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.015=true}}] run data modify storage area: capture.skylands.015 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.016=true}}] run data modify storage area: capture.skylands.016 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.017=true}}] run data modify storage area: capture.skylands.017 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.018=true}}] run data modify storage area: capture.skylands.018 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.019=true}}] run data modify storage area: capture.skylands.019 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.020=true}}] run data modify storage area: capture.skylands.020 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.021=true}}] run data modify storage area: capture.skylands.021 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.022=true}}] run data modify storage area: capture.skylands.022 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.023=true}}] run data modify storage area: capture.skylands.023 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.024=true}}] run data modify storage area: capture.skylands.024 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.025=true}}] run data modify storage area: capture.skylands.025 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.026=true}}] run data modify storage area: capture.skylands.026 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.027=true}}] run data modify storage area: capture.skylands.027 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.028=true}}] run data modify storage area: capture.skylands.028 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.029=true}}] run data modify storage area: capture.skylands.029 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.030=true}}] run data modify storage area: capture.skylands.030 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.031=true}}] run data modify storage area: capture.skylands.031 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.032=true}}] run data modify storage area: capture.skylands.032 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.033=true}}] run data modify storage area: capture.skylands.033 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.034=true}}] run data modify storage area: capture.skylands.034 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.035=true}}] run data modify storage area: capture.skylands.035 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.036=true}}] run data modify storage area: capture.skylands.036 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.037=true}}] run data modify storage area: capture.skylands.037 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.038=true}}] run data modify storage area: capture.skylands.038 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.039=true}}] run data modify storage area: capture.skylands.039 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.040=true}}] run data modify storage area: capture.skylands.040 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.041=true}}] run data modify storage area: capture.skylands.041 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.042=true}}] run data modify storage area: capture.skylands.042 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.043=true}}] run data modify storage area: capture.skylands.043 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.044=true}}] run data modify storage area: capture.skylands.044 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.045=true}}] run data modify storage area: capture.skylands.045 set value 1
execute if entity @s[advancements={area:system/island_capture={skylands.046=true}}] run data modify storage area: capture.skylands.046 set value 1
# ##flying_island
execute if entity @s[advancements={area:system/island_capture={flying_island.001=true}}] run data modify storage area: capture.flying_island.046 set value 1
execute if entity @s[advancements={area:system/island_capture={flying_island.002=true}}] run data modify storage area: capture.flying_island.047 set value 1
# ##cloudia
# execute if entity @s[advancements={area:system/island_capture={cloudia.001=true}}] run data modify storage area: capture.cloudia.048 set value 1
# execute if entity @s[advancements={area:system/island_capture={cloudia.002=true}}] run data modify storage area: capture.cloudia.049 set value 1
# execute if entity @s[advancements={area:system/island_capture={cloudia.003=true}}] run data modify storage area: capture.cloudia.050 set value 1

# 追加： 島攻略時にその島のフレームにあるマーカーとブロックディスプレイのタグを外す
##skylands
execute if entity @s[advancements={area:system/island_capture={skylands.001=true}}] positioned -22.0 1.0 -593.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.002=true}}] positioned -75.0 13.0 -619.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.003=true}}] positioned -9.0 2.0 -646.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.005=true}}] positioned 7.0 20.0 -557.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.006=true}}] positioned 35.0 8.0 -648.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.007=true}}] positioned 39.0 6.0 -555.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.008=true}}] positioned -35.0 84.0 -555.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.009=true}}] positioned 62.0 26.0 -452.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.010=true}}] positioned -60.0 44.0 -646.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.011=true}}] positioned 3.0 77.0 -537.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.012=true}}] positioned 17.0 35.0 -664.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.013=true}}] positioned 16.0 12.0 -685.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.014=true}}] positioned 62.0 16.0 -662.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.015=true}}] positioned -128.0 23.0 -600.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.016=true}}] positioned -105.0 13.0 -704.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.017=true}}] positioned -52.0 60.0 -678.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.018=true}}] positioned -3.0 69.0 -632.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.019=true}}] positioned 103.0 20.0 -728.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.020=true}}] positioned -69.0 97.0 -634.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.021=true}}] positioned 39.0 78.0 -596.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.022=true}}] positioned 66.0 51.0 -537.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.023=true}}] positioned 157.0 36.0 -552.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.024=true}}] positioned 296.0 47.0 -581.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.025=true}}] positioned 67.0 45.0 -682.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.026=true}}] positioned 157.0 69.0 -645.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.027=true}}] positioned 104.0 127.0 -645.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.028=true}}] positioned 164.0 63.0 -768.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.029=true}}] positioned 178.0 19.0 -700.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.030=true}}] positioned -59.0 74.0 -741.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.031=true}}] positioned 62.0 2.0 -785.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.032=true}}] positioned 128.0 144.0 -590.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.033=true}}] positioned 93.0 147.0 -549.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.034=true}}] positioned 236.0 85.0 -460.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.035=true}}] positioned 244.0 197.0 -750.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.036=true}}] positioned 86.0 110.0 -718.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.037=true}}] positioned -27.0 113.0 -668.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.038=true}}] positioned 19.0 168.0 -462.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.039=true}}] positioned -77.0 172.0 -536.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.040=true}}] positioned -132.0 156.0 -684.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.041=true}}] positioned -94.0 159.0 -775.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.042=true}}] positioned 101.0 162.0 -850.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.043=true}}] positioned -171.0 99.0 -778.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.044=true}}] positioned 111.0 35.0 -601.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.045=true}}] positioned 22.0 213.0 -664.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={skylands.046=true}}] positioned 226.0 309.0 -923.0 positioned ~ ~ ~0.005 run function area:system/island_remove
# ##flying_island
execute if entity @s[advancements={area:system/island_capture={flying_island.001=true}}] positioned -797.0 100.0 -773.0 positioned ~ ~ ~0.005 run function area:system/island_remove
execute if entity @s[advancements={area:system/island_capture={flying_island.002=true}}] positioned -802.0 131.0 -677.0 positioned ~ ~ ~0.005 run function area:system/island_remove

#クリア数抽出
execute store result score _ Calc run function calc:island/clear_count
execute store result score # _ run function calc:island/get_total
execute store result score # Calc run function calc:island/clear_count_percent

#クリアを通知
execute at @a run playsound minecraft:ui.toast.challenge_complete player @a ~ ~ ~ 0.25 1 0
title @a title [{"translate":"島 攻略率"}," ",{"score":{"name": "_","objective": "Calc"}},"/",{"score":{"name": "#","objective": "_"}},"(",{"score":{"name": "#","objective": "Calc"}},"%)"]
tellraw @a [{"translate":"攻略時間:%1$s時間%2$s分%3$s秒","color":"gold","with":[{"score":{"name":"$Hours","objective":"Count"}},{"score":{"name":"$Minutes","objective":"Count"}},[{"score":{"name":"$TenSeconds","objective":"Count"}},{"score":{"name":"$Seconds","objective":"Count"}}]]}]

# おめでとう！ メッセージ
    execute if score # Calc matches 100.. run schedule function area:system/all_clear_message 3s

#夜を司る島(月島)
execute if entity @s[advancements={area:system/island_capture={skylands.011=true}}] run function area:system/skylands/moon

#リセット
advancement revoke @s only area:system/island_capture